<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>repl.it</title>
    <link href="style.css" rel="stylesheet" type="text/css" />
  </head>
  <body>
   
    <canvas width="500" height="500" id="canvas">not supported</canvas>

   
    
    <script src="script.js">
    </script>
    

    <br>
    <label>delay (ms)</label>
    <input type="number" value="0" id="delay">
    <br>
    <button id="reset_button">reset</button>
    <button id="breadth first">Breadth First Search</button>
    <button id="diijkstra">Diijkstra</button>
    <button id="setDirectional">set Directional</button>
    <button id="setBiDirectional">set BiDirectional</button>
    <br>
    <br>
    <canvas width="600" height="300" id="canvas2">not supported</canvas>
    <br>
    <br>
    <canvas width="600" height="600" id="canvas3">not supported</canvas>
    <script>

      let breadth_first_button = document.getElementById("breadth first");
      let reset_button = document.getElementById("reset_button");
      let diijkstra_button = document.getElementById("diijkstra");
      let setDirectional_button = document.getElementById("setDirectional");
      let setBiDirectional_button = document.getElementById("setBiDirectional");
      breadth_first_button.addEventListener('click', breadth_wrapper);
      diijkstra_button.addEventListener('click', diijkstra_wrapper);
      reset_button.addEventListener('click', reset);
      setDirectional.addEventListener('click', ()=>nodeking.setDirectional());
      setBiDirectional.addEventListener('click', ()=>nodeking.setBiDirectional());


      const sleep = (milliseconds) => {
        return new Promise(resolve => setTimeout(resolve, milliseconds))
      }

      function getStartId(){
        let start = nodeking.getChildrenByText("start");
        
        return start[0].id;
      }

      function getEndId(){
        let end = nodeking.getChildrenByText("end");
        
        return end[0].id;
      }

      function reset(){
        Object.values(nodeking.edges).map(edge => edge.color = "black");
      }

      async function diijkstra_wrapper(){
        reset();
        console.log("here we go")
        let thing = await nodeking.diijkstra(getStartId(), getEndId(), true);
        
        console.log(thing)
      }

      async function breadth_wrapper(){
        reset();
        let delay =  Number(document.getElementById("delay").value);
        console.log(delay);
        console.log("start");
        console.log("start "+getStartId());
        console.log("end "+getEndId());
        let thing = await nodeking.breadthFirstSearch(getStartId(), getEndId(), true, delay);
        console.log("here we go: ")
        console.log(thing)
        
      }
      function log_all_values(){
        nodeking.objs.map((node)=>console.log(node.value));
      }
    </script>
    <script>
      let canvas = document.getElementById("canvas");
      let nodeking = new Graph("canvas");
      let start = nodeking.node(100, 100, 40, "start");
      let medium = nodeking.node(300, 200, 35, "thing");
      let end = nodeking.node(100, 400, 40, "end");

      start.directional(medium, 13);
      medium.biDirectional(end, 5);
      end.directional(start, 1);

      let nodeking2 = new Graph("canvas2");


      nodeking2.setNodeCreatedCallback((node)=>{
        let images = ["https://media1.popsugar-assets.com/files/thumbor/LfOJxhNfU8EftMFF_YPT5Fm5PwQ/263x100:2721x2558/fit-in/2048xorig/filters:format_auto-!!-:strip_icc-!!-/2020/04/06/953/n/1922398/d81efb315e8ba4da48b3b7.11171110_/i/Kevin-Bacon.jpg",
        "https://pbs.twimg.com/profile_images/1240039886343688192/ddEgtzqr_400x400.jpg",
        "https://m.media-amazon.com/images/M/MV5BOTQxMTEyMjI0NV5BMl5BanBnXkFtZTgwODE4ODAzMjE@._V1_.jpg",
        "https://media.npr.org/assets/img/2011/11/22/kevinbacon_custom-008ac9d4aa108bcc152d5813a006362d286d6984-s800-c85.jpg"
        ]
        node.setImage(images[Math.floor(Math.random()*images.length)]);
      
      })
      
      let nodeking3 = new Graph("canvas3");
      let edges = []
      function animateNode(node){
        let graph = nodeking3;
        let x = (Math.random()*6)-3;
        let y = (Math.random()*6)-3;
        function move(){
          node.x += x;
          node.y += y;
          if(node.x-node.r < 0){
            x *= -1;
          }
          if(node.x+node.r > graph.canvas.width){
            x *= -1;
          }
          if(node.y+node.r > graph.canvas.width){
            y *= -1
          }
          if(node.y-node.r < 0){
            y *= -1
          }
          for(edge of edges){
            edge.setText(Math.round(nodeking3.getDistance(edge.getStartid(), edge.getEndid())))
          }
          setTimeout(move, 1000/60)
        }
        move()
      }
      function addEdge(edge){
        edges.push(edge);
      }
      nodeking3.setNodeSetupCallback(animateNode)
      nodeking3.setConnectionCreatedCallback(addEdge)
      let A = nodeking3.node(100, 100, 20)
      let B = nodeking3.node(200, 200, 20)
      A.connect

      
      
    </script>
  </body>
</html>